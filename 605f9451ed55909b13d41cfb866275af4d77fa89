{
  "comments": [
    {
      "key": {
        "uuid": "9ab29df4_9c74c5fe",
        "filename": "tests/mdts/tests/functional_tests/test_zoom_connection_loss.py",
        "patchSetId": 4
      },
      "lineNbr": 87,
      "author": {
        "id": 1003318
      },
      "writtenOn": "2015-10-26T19:01:19Z",
      "side": 1,
      "message": "Should we add another test that does exactly the same BUT also checking that agents stop working after the timeout expires? Something like:\n- check ping works\n- sabotage connection ZK\n- check ping works for 20s\n- wait 20 more seconds (just to be safe)\n- check ping does not work (meaning agents have been completely partitioned)\n- recover connection with ZK\n- check ping works again",
      "revId": "605f9451ed55909b13d41cfb866275af4d77fa89",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ab29df4_b817e350",
        "filename": "tests/mdts/tests/functional_tests/test_zoom_connection_loss.py",
        "patchSetId": 4
      },
      "lineNbr": 113,
      "author": {
        "id": 1002731
      },
      "writtenOn": "2015-10-21T17:51:47Z",
      "side": 1,
      "message": "To avoid flakiness, is there any more reliable way to ensure that traffic is indeed interrupted? I assume inject_packet_loss_for_ip is not vulnerable to environment slowness, but just in case.",
      "range": {
        "startLine": 113,
        "startChar": 3,
        "endLine": 113,
        "endChar": 17
      },
      "revId": "605f9451ed55909b13d41cfb866275af4d77fa89",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ab29df4_7ee293d6",
        "filename": "tests/mdts/tests/functional_tests/test_zoom_connection_loss.py",
        "patchSetId": 4
      },
      "lineNbr": 113,
      "author": {
        "id": 1006342
      },
      "writtenOn": "2015-10-22T07:57:44Z",
      "side": 1,
      "message": "I think the traffic is instantly interrupted on return of the inject_packet_loss_for_ip. It executes iptables inside the container and waits for it to return and i think once iptables returns the traffic is blocked. I forgot why I added this sleep, should I remove it?",
      "parentUuid": "9ab29df4_b817e350",
      "range": {
        "startLine": 113,
        "startChar": 3,
        "endLine": 113,
        "endChar": 17
      },
      "revId": "605f9451ed55909b13d41cfb866275af4d77fa89",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ab29df4_5c922d58",
        "filename": "tests/mdts/tests/functional_tests/test_zoom_connection_loss.py",
        "patchSetId": 4
      },
      "lineNbr": 113,
      "author": {
        "id": 1003318
      },
      "writtenOn": "2015-10-26T17:59:00Z",
      "side": 1,
      "message": "Yes, traffic is blocked as soon as iptables returns so it is safe to remove this sleep.",
      "parentUuid": "9ab29df4_7ee293d6",
      "range": {
        "startLine": 113,
        "startChar": 3,
        "endLine": 113,
        "endChar": 17
      },
      "revId": "605f9451ed55909b13d41cfb866275af4d77fa89",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ab29df4_bc88a923",
        "filename": "tests/mdts/tests/functional_tests/test_zoom_connection_loss.py",
        "patchSetId": 4
      },
      "lineNbr": 120,
      "author": {
        "id": 1003318
      },
      "writtenOn": "2015-10-26T17:59:00Z",
      "side": 1,
      "message": "Isn\u0027t it easier to just do something like:\ntimeout \u003d 20\nwhile (timeout \u003e 0):\n    ....\n    timeout -\u003d 1\n    time.sleep(1)",
      "revId": "605f9451ed55909b13d41cfb866275af4d77fa89",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ab29df4_c22658ba",
        "filename": "tests/mdts/tests/functional_tests/test_zoom_connection_loss.py",
        "patchSetId": 4
      },
      "lineNbr": 120,
      "author": {
        "id": 1006342
      },
      "writtenOn": "2015-10-27T07:34:44Z",
      "side": 1,
      "message": "Because we wait for the ping everytime and if in whatever circumstances the average delay of the ping is higher than 500 milliseconds (time.sleep should be accurate on linux) the total waiting time will be over 30 seconds and that makes it another test case.\n\nCan change it to a counter if you prefer that.",
      "parentUuid": "9ab29df4_bc88a923",
      "revId": "605f9451ed55909b13d41cfb866275af4d77fa89",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}