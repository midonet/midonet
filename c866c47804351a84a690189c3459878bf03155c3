{
  "comments": [
    {
      "key": {
        "uuid": "5ac4a560_3d2ca1ab",
        "filename": "midonet-cluster/src/main/scala/org/midonet/cluster/services/rest_api/resources/RuleResource.scala",
        "patchSetId": 9
      },
      "lineNbr": 43,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-11-26T15:13:11Z",
      "side": 1,
      "message": "Maybe it\u0027s not important for now but we are not using transactions for get requests. Meaning that the rule may have been modified between the store.get for the rule and for the chain...",
      "range": {
        "startLine": 43,
        "startChar": 27,
        "endLine": 43,
        "endChar": 36
      },
      "revId": "c866c47804351a84a690189c3459878bf03155c3",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ac4a560_0ff966c8",
        "filename": "midonet-cluster/src/main/scala/org/midonet/cluster/services/rest_api/resources/RuleResource.scala",
        "patchSetId": 9
      },
      "lineNbr": 43,
      "author": {
        "id": 1002821
      },
      "writtenOn": "2015-11-27T01:55:08Z",
      "side": 1,
      "message": "That\u0027s a good point, although completely irrelevant to this patch. How were you able to leave a comment here? This file doesn\u0027t even show up on the list of changes.\n\nUnfortunately, Zookeeper doesn\u0027t provide a way to do multi reads. To do this, what you have to do is:\n\n1. Get the current zxid of the server before the first read.\n2. For each node you get, make sure that the zxid at which it was last modified is less than the zxid you got in step 1.\n\nWe actually do this with write transactions, but the only way I know of to get the current zxid is to do a create or update and then query the stats of the node you just created/update. Doing a write before every read seems like a dealbreaker. It seems like there should be a way to get the server\u0027s current zxid without doing an update, but I haven\u0027t found one.",
      "parentUuid": "5ac4a560_3d2ca1ab",
      "range": {
        "startLine": 43,
        "startChar": 27,
        "endLine": 43,
        "endChar": 36
      },
      "revId": "c866c47804351a84a690189c3459878bf03155c3",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ac4a560_4f76fe3f",
        "filename": "midonet-cluster/src/main/scala/org/midonet/cluster/services/rest_api/resources/RuleResource.scala",
        "patchSetId": 9
      },
      "lineNbr": 43,
      "author": {
        "id": 1002821
      },
      "writtenOn": "2015-11-27T03:49:55Z",
      "side": 1,
      "message": "Oh, I see. It shows up in the v8 -\u003e v9 diff. That\u0027s just due to the rebase; this patch doesn\u0027t change this file at all.\n\nAlso, I found out that you can get the current zxid by opening a TCP connection to ZK and sending \"srvr\":\n\n  % echo srvr | nc localhost 2181\n  Zookeeper version: 3.4.5--1, built on 06/10/2013 17:26 GMT\n  Latency min/avg/max: 0/0/18\n  Received: 63247\n  Sent: 63247\n  Connections: 4\n  Outstanding: 0\n  Zxid: 0x10d6b3\n  Mode: standalone\n  Node count: 28348\n\nThat\u0027s lightweight enough that we could do that.",
      "parentUuid": "5ac4a560_0ff966c8",
      "range": {
        "startLine": 43,
        "startChar": 27,
        "endLine": 43,
        "endChar": 36
      },
      "revId": "c866c47804351a84a690189c3459878bf03155c3",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}