{
  "comments": [
    {
      "key": {
        "uuid": "9ad9bd40_e0c9805b",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 39,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "I think the main issue here is that this mapper needs to be self-contained more like a service, rather than the mappers we wrote previously. Before, the mappers were translating between storage and requests from consumers. However, in this case, the mapper is a consumer by itselft, having to update the vxlan port map.\n\nHere, the mapper exposes an observable that isn\u0027t used anywhere except for the tests, hence it looks like it won\u0027t do anything. My suggestions are:\n\n(1)\n- this mapper should be like a service, with start/stop methods (start with the agent, stop with the agent)\n- no need to expose an observable, all consumers go to the map\n- the observable must be subscribed internally and the consumed notifications should update the map\n\nor (2)\n- this mapper exposes an observable, there is no start/stop\n- the VTPM is the consumer and subscribes to the observable upon start/unsubscribes upon stop\n- the VTPM may consume the updates and update the vxlan port map, or the mapper can do it",
      "range": {
        "startLine": 39,
        "startChar": 7,
        "endLine": 39,
        "endChar": 22
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_a33a1d96",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 39,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "I opted for (1).",
      "parentUuid": "9ad9bd40_e0c9805b",
      "range": {
        "startLine": 39,
        "startChar": 7,
        "endLine": 39,
        "endChar": 22
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_60bad0e2",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 46,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "This can be a simple reference since start is only called once.",
      "range": {
        "startLine": 46,
        "startChar": 4,
        "endLine": 46,
        "endChar": 70
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_a0ddb844",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 46,
      "author": {
        "id": 1002731
      },
      "writtenOn": "2015-09-01T12:02:32Z",
      "side": 1,
      "message": "this will force you to go through he lock all the time. Why not initialize an instance directly, and add a .start() method to start the subscriptions?",
      "range": {
        "startLine": 46,
        "startChar": 27,
        "endLine": 46,
        "endChar": 70
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_c341e10c",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 46,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "The VirtualToPhysicalMapper now holds the reference to the service object.",
      "parentUuid": "9ad9bd40_a0ddb844",
      "range": {
        "startLine": 46,
        "startChar": 27,
        "endLine": 46,
        "endChar": 70
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_0077443c",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 48,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "This method returns an observable, yet it is not used anywhere except than in the tests. A start method should return something like Unit or a Future signaling completion. Also some documentation would be nice.",
      "range": {
        "startLine": 48,
        "startChar": 26,
        "endLine": 48,
        "endChar": 52
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_e344251d",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 48,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "This method got removed.",
      "parentUuid": "9ad9bd40_0077443c",
      "range": {
        "startLine": 48,
        "startChar": 26,
        "endLine": 48,
        "endChar": 52
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_608f3024",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 62,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "Since this is used in the simulation, it would be more efficient to access the map directly.",
      "range": {
        "startLine": 58,
        "startChar": 8,
        "endLine": 62,
        "endChar": 9
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_034bc92b",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 62,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_608f3024",
      "range": {
        "startLine": 58,
        "startChar": 8,
        "endLine": 62,
        "endChar": 9
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_c0e0fcfc",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 70,
      "author": {
        "id": 1002731
      },
      "writtenOn": "2015-09-01T12:02:32Z",
      "side": 1,
      "message": "rather in NSDB",
      "range": {
        "startLine": 70,
        "startChar": 23,
        "endLine": 70,
        "endChar": 44
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_23460d22",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 70,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_c0e0fcfc",
      "range": {
        "startLine": 70,
        "startChar": 23,
        "endLine": 70,
        "endChar": 44
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_e0e6e015",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 71,
      "author": {
        "id": 1002731
      },
      "writtenOn": "2015-09-01T12:02:32Z",
      "side": 1,
      "message": "have",
      "range": {
        "startLine": 71,
        "startChar": 45,
        "endLine": 71,
        "endChar": 48
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_4355d1c4",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 71,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_e0e6e015",
      "range": {
        "startLine": 71,
        "startChar": 45,
        "endLine": 71,
        "endChar": 48
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_00e2e400",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 74,
      "author": {
        "id": 1002731
      },
      "writtenOn": "2015-09-01T12:02:32Z",
      "side": 1,
      "message": "vteps?",
      "range": {
        "startLine": 74,
        "startChar": 55,
        "endLine": 74,
        "endChar": 63
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_635015d5",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 74,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_00e2e400",
      "range": {
        "startLine": 74,
        "startChar": 55,
        "endLine": 74,
        "endChar": 63
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_00f3c49f",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 77,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "Set logger source",
      "range": {
        "startLine": 77,
        "startChar": 12,
        "endLine": 77,
        "endChar": 27
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_835ef9e7",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 77,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_00f3c49f",
      "range": {
        "startLine": 77,
        "startChar": 12,
        "endLine": 77,
        "endChar": 27
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_c012bc08",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 82,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "Make this an immutable map. Also: should it be volatile?",
      "range": {
        "startLine": 82,
        "startChar": 33,
        "endLine": 82,
        "endChar": 40
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_c35801fd",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 82,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "I made it immutable and volatile.",
      "parentUuid": "9ad9bd40_c012bc08",
      "range": {
        "startLine": 82,
        "startChar": 33,
        "endLine": 82,
        "endChar": 40
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_a0269866",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 86,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "Nit: VtepStateStorage provides implicit access to the vtep methods. You just need to import:\n\n  import VtepStateStorage._\n\nand then you can call:\n\n  vt.backend.stateStore.vtepMethod",
      "range": {
        "startLine": 85,
        "startChar": 4,
        "endLine": 86,
        "endChar": 66
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_830519c4",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 86,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_a0269866",
      "range": {
        "startLine": 85,
        "startChar": 4,
        "endLine": 86,
        "endChar": 66
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_c0b9dc7a",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 101,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "can this be a Map[portId -\u003e vtepId]? It would make it simpler/faster to remove a vxlan port from this network.",
      "range": {
        "startLine": 101,
        "startChar": 34,
        "endLine": 101,
        "endChar": 63
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_03dbc9ed",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 101,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "When I delete entries in this list, I delete the entry with a given vtepId, so the key in the map would have to be that. However, in the beginning we have vtepId \u003d\u003d null. Also I use this list to determine if I have received all ports (hence vtepId needs to be null before we receive the given port).\nThe conclusion is that I don\u0027t see how a map would help.",
      "parentUuid": "9ad9bd40_c0b9dc7a",
      "range": {
        "startLine": 101,
        "startChar": 34,
        "endLine": 101,
        "endChar": 63
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_40ececf3",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 108,
      "author": {
        "id": 1002731
      },
      "writtenOn": "2015-09-01T12:02:32Z",
      "side": 1,
      "message": "Probably a while with the iterator will be preferred to reduce garbage",
      "range": {
        "startLine": 108,
        "startChar": 8,
        "endLine": 108,
        "endChar": 52
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_e3aee597",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 108,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_40ececf3",
      "range": {
        "startLine": 108,
        "startChar": 8,
        "endLine": 108,
        "endChar": 52
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_83eef989",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 108,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:21:31Z",
      "side": 1,
      "message": "Should I do the same for loops in method vtepUpdated?",
      "parentUuid": "9ad9bd40_e3aee597",
      "range": {
        "startLine": 108,
        "startChar": 8,
        "endLine": 108,
        "endChar": 52
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_c0b71cf4",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 109,
      "author": {
        "id": 1002731
      },
      "writtenOn": "2015-09-01T12:02:32Z",
      "side": 1,
      "message": "declaration should be in lines above",
      "range": {
        "startLine": 109,
        "startChar": 16,
        "endLine": 109,
        "endChar": 29
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_439f915f",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 109,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "It\u0027s now a while loop and so this if is inside the while block.",
      "parentUuid": "9ad9bd40_c0b71cf4",
      "range": {
        "startLine": 109,
        "startChar": 16,
        "endLine": 109,
        "endChar": 29
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_40e06c96",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 149,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "If you use clone, why not make the set immutable? On the next line you could create a new set and add it to the vtepBindings map. Then you wouldn\u0027t need to clear the old map, and add all the new elements again.",
      "range": {
        "startLine": 149,
        "startChar": 40,
        "endLine": 149,
        "endChar": 48
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_e39c2560",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 149,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_40e06c96",
      "range": {
        "startLine": 149,
        "startChar": 40,
        "endLine": 149,
        "endChar": 48
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_e0da60e8",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 155,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "VTEP",
      "range": {
        "startLine": 155,
        "startChar": 19,
        "endLine": 155,
        "endChar": 23
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_03a3c99e",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 155,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_e0da60e8",
      "range": {
        "startLine": 155,
        "startChar": 19,
        "endLine": 155,
        "endChar": 23
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_a0fe9869",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 159,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "Nit: parentheses not needed.",
      "range": {
        "startLine": 159,
        "startChar": 43,
        "endLine": 159,
        "endChar": 44
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_43add187",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 159,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_a0fe9869",
      "range": {
        "startLine": 159,
        "startChar": 43,
        "endLine": 159,
        "endChar": 44
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_a3f13d6c",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 159,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:21:31Z",
      "side": 1,
      "message": "Also use iterator here?",
      "range": {
        "startLine": 159,
        "startChar": 8,
        "endLine": 159,
        "endChar": 81
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_e001803a",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 160,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "remove?",
      "range": {
        "startLine": 160,
        "startChar": 57,
        "endLine": 160,
        "endChar": 72
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_239e0d55",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 160,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_e001803a",
      "range": {
        "startLine": 160,
        "startChar": 57,
        "endLine": 160,
        "endChar": 72
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_a09f7802",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 162,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "You could remove the port from this network in networksPortMap, and then check whether that list is empty. In this way you don\u0027t have to search through all the networks/bindings.",
      "range": {
        "startLine": 162,
        "startChar": 12,
        "endLine": 162,
        "endChar": 38
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_033f4926",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 162,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_a09f7802",
      "range": {
        "startLine": 162,
        "startChar": 12,
        "endLine": 162,
        "endChar": 38
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_20fc483e",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 166,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "remove?",
      "range": {
        "startLine": 166,
        "startChar": 26,
        "endLine": 166,
        "endChar": 41
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_23f44dce",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 166,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_20fc483e",
      "range": {
        "startLine": 166,
        "startChar": 26,
        "endLine": 166,
        "endChar": 41
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_c3e8017f",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 177,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:21:31Z",
      "side": 1,
      "message": "iterator?",
      "range": {
        "startLine": 177,
        "startChar": 8,
        "endLine": 177,
        "endChar": 79
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_599a1e6f",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 177,
      "author": {
        "id": 1002731
      },
      "writtenOn": "2015-09-02T19:36:54Z",
      "side": 1,
      "message": "Yes, within the agent I\u0027d try to minimize garbage",
      "parentUuid": "9ad9bd40_c3e8017f",
      "range": {
        "startLine": 177,
        "startChar": 8,
        "endLine": 177,
        "endChar": 79
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_4a1dde65",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 177,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-03T11:32:12Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_599a1e6f",
      "range": {
        "startLine": 177,
        "startChar": 8,
        "endLine": 177,
        "endChar": 79
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_ebaec1e6",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 182,
      "author": {
        "id": 1002731
      },
      "writtenOn": "2015-09-01T12:02:32Z",
      "side": 1,
      "message": "you can .take(1) and get the network as you won\u0027t need the observable",
      "range": {
        "startLine": 182,
        "startChar": 12,
        "endLine": 182,
        "endChar": 70
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_03202948",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 182,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_ebaec1e6",
      "range": {
        "startLine": 182,
        "startChar": 12,
        "endLine": 182,
        "endChar": 70
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_4b5ded14",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 208,
      "author": {
        "id": 1002731
      },
      "writtenOn": "2015-09-01T12:02:32Z",
      "side": 1,
      "message": "why do you need to watch networks?",
      "range": {
        "startLine": 208,
        "startChar": 16,
        "endLine": 208,
        "endChar": 30
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_83d35937",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 208,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "This is invoked only once per network. I can change the name of this method to networkReceived.",
      "parentUuid": "9ad9bd40_4b5ded14",
      "range": {
        "startLine": 208,
        "startChar": 16,
        "endLine": 208,
        "endChar": 30
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_6b9b91c9",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 216,
      "author": {
        "id": 1002731
      },
      "writtenOn": "2015-09-01T12:02:32Z",
      "side": 1,
      "message": "vni never changes, so you don\u0027t need to watch for its updates after loading it on the first time",
      "range": {
        "startLine": 216,
        "startChar": 8,
        "endLine": 216,
        "endChar": 38
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_c3dd6144",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 216,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "I just get the first notification (see take(1) above). So this will be executed only once per network.",
      "parentUuid": "9ad9bd40_6b9b91c9",
      "range": {
        "startLine": 216,
        "startChar": 8,
        "endLine": 216,
        "endChar": 38
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_2058c855",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 226,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "This could be simpler:\n\n   store.observable(classOf[Port], portId)\n                     .observeOn(vt.vtScheduler)\n                     .take(1)\n                     .map(makeFunc1(port \u003d\u003e (networkId, port)))",
      "range": {
        "startLine": 221,
        "startChar": 12,
        "endLine": 226,
        "endChar": 31
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_03ce6983",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 226,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_2058c855",
      "range": {
        "startLine": 221,
        "startChar": 12,
        "endLine": 226,
        "endChar": 31
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_c03e3cda",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 300,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "find",
      "range": {
        "startLine": 300,
        "startChar": 54,
        "endLine": 300,
        "endChar": 60
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_43c87174",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 300,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_c03e3cda",
      "range": {
        "startLine": 300,
        "startChar": 54,
        "endLine": 300,
        "endChar": 60
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_e0d0a0f9",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 310,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "This should be a val, otherwise every call will create a new observable, each that will \"update\"(1) the map.\n\n(1) See next comment",
      "range": {
        "startLine": 310,
        "startChar": 22,
        "endLine": 310,
        "endChar": 25
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_63c3b557",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 310,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_e0d0a0f9",
      "range": {
        "startLine": 310,
        "startChar": 22,
        "endLine": 310,
        "endChar": 25
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_40d6acf2",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 317,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "In the agent, this needs a subscriber, otherwise the map will never be updated. While you subscribe in the unit tests, this observable is unused otherwise.",
      "range": {
        "startLine": 316,
        "startChar": 17,
        "endLine": 317,
        "endChar": 57
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_a3a4ddb9",
        "filename": "midolman/src/main/scala/org/midonet/midolman/topology/VxLanPortMapper.scala",
        "patchSetId": 9
      },
      "lineNbr": 317,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "The subscriber is in the VTPM now.",
      "parentUuid": "9ad9bd40_40d6acf2",
      "range": {
        "startLine": 316,
        "startChar": 17,
        "endLine": 317,
        "endChar": 57
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_a035b847",
        "filename": "midolman/src/test/scala/org/midonet/midolman/topology/VxLanPortMapperTest.scala",
        "patchSetId": 9
      },
      "lineNbr": 163,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T11:07:05Z",
      "side": 1,
      "message": "I think the unit tests should be oriented to how the mapper is used by the agent, i.e. calls to the map rather than subscription to the observable.",
      "range": {
        "startLine": 162,
        "startChar": 12,
        "endLine": 163,
        "endChar": 49
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_40f2279b",
        "filename": "midolman/src/test/scala/org/midonet/midolman/topology/VxLanPortMapperTest.scala",
        "patchSetId": 9
      },
      "lineNbr": 163,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ad9bd40_a035b847",
      "range": {
        "startLine": 162,
        "startChar": 12,
        "endLine": 163,
        "endChar": 49
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_0bd685c3",
        "filename": "nsdb/src/main/proto/state.proto",
        "patchSetId": 9
      },
      "lineNbr": 66,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2015-09-01T13:32:11Z",
      "side": 1,
      "message": "Is this needed? The state storage doesn\u0027t seem to write this field",
      "range": {
        "startLine": 66,
        "startChar": 4,
        "endLine": 66,
        "endChar": 30
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_c69c9460",
        "filename": "nsdb/src/main/proto/state.proto",
        "patchSetId": 9
      },
      "lineNbr": 66,
      "author": {
        "id": 1002820
      },
      "writtenOn": "2015-09-02T13:20:01Z",
      "side": 1,
      "message": "With this, I can observage the config of a vtep and directly get the vtepId from the proto. Arguably I could also combine my observable with one that emits the vtep id. Whichever way is fine by me.",
      "parentUuid": "9ad9bd40_0bd685c3",
      "range": {
        "startLine": 66,
        "startChar": 4,
        "endLine": 66,
        "endChar": 30
      },
      "revId": "6a0c6da6978022a52f285f32fa7cc8e51026843f",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}